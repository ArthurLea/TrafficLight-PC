C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: E:\Single-Chip-Microcomputer\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <reg52.h>
   2          #include "config.h"
   3          #include "max7219.h"
   4          #include "led.h"
   5          #include "key.h"
   6          #include "uart.h"
   7          #include "infrared_tube.h"
   8          
   9          //´®¿ÚÐèÒª±äÁ¿
  10          volatile uchar uartState = UART_IDLE;
  11          volatile uint timeout;
  12          volatile uint pointer;
  13          
  14          volatile uchar g_cCommand; 
  15          volatile uchar send_Buf[16] = {0};//Í¨¹ý´®¿Ú×ªÀ¶ÑÀ·¢ËÍ¸øÊÖ»úµÄ»º³åÇø
  16          volatile uchar recieve_Buf[16] = {0};//Êý¾Ý½ÓÊÕµÄ»º³åÇø
  17          /*×Ô¶¯Ä£Ê½,Ä¬ÈÏ¸÷·½Ïò¾ùÎª20s,Í¬Ê±¿ªÊ¼ÒÔÄÏ±±·½ÏòÎª×¼£¬ÄÏ±±ÎªÂÌ£¬¶«Î÷Îªºì
  18           *ÊÖ¶¯Ä£Ê½,²Ù×÷Õß×Ô¼ºÉèÖÃÄÏ±±¶«Î÷·½ÏòÉÏµÄÂÌµÆÊ±¼ä
  19           *×¢Òâ£ºÄÏ±±·½ÏòÉÏµÄÂÌµÆÊ±¼äºÍ¶«Î÷·½ÏòÉÏµÄºìµÆÊ±¼äÏàÍ¬
  20           *      ¶«Î÷·½ÏòÉÏµÄÂÌµÆÊ±¼äºÍÄÏ±±·½ÏòÉÏµÄºìµÆÊ±¼äÏàÍ¬
  21           */
  22          //ºìÂÌ»ÆµÆÊ±¼äÈ«¾ÖÒ×±ä±äÁ¿
  23          volatile uchar Sou_Nor_Red_Time = 5;
  24          volatile uchar Sou_Nor_Green_Time = 5;
  25          volatile uchar Sou_Nor_Yellow_Time = 2;
  26          volatile uchar West_East_Yellow_Time = 2;
  27          
  28          //ºìÂÌµÆÊ±Ê±¼ä±¸·Ý
  29          volatile uchar Sou_Nor_Red_Time_Temp;
  30          volatile uchar Sou_Nor_Green_Time_Temp;
  31          
  32          uchar code big_time = 10;//³¤Ê±¼ä
  33          uchar code small_time = 5;//¶ÌÊ±¼ä
  34          
  35          volatile uchar Phone_OK_Finish = 0;//ÊÖ»úÉèÖÃÍê±Ï±ê¼Ç
  36          //Íâ²¿¹²Ïí±äÁ¿
  37          extern uchar enter_stop_flag;//½ûÖ¹Í¨ÐÐ±ê¼Ç
  38          volatile uchar quit_stop_flag = 0;
  39          extern uchar car_flow_detection_flag;
  40          //³µÁ÷Á¿¼ì²â
  41          volatile uint car_num[4] = {0,0,0,0};//0-¶«·½ÏòÉÏµÄ³µÁ÷Á¿
  42                                                                                          //1-ÄÏ·½Ïò
  43                                                                                          //2-Î÷·½Ïò
  44                                                                                          //3-±±·½Ïò
  45          extern volatile uchar cycle_nums;//from interrupt.c file   
  46          
  47          //º¯ÊýÉùÃ÷
  48          void init_register_s52();
  49          void init_Numeric_Display();
  50          void phone_remote_set();
  51          void phone_remote_control();
  52          
  53          void clearFlag()
  54          {
  55   1              Phone_OK_Finish = 0;
C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 2   

  56   1              enter_stop_flag = 0;
  57   1              quit_stop_flag = 0;
  58   1              car_flow_detection_flag = 0;    
  59   1      }
  60          int main()
  61          {
  62   1              uchar key_num = 17;/*µ±Ç°°´¼üÖµ*/
  63   1              uint run_red_light_result = 0;/*´³ºìÂÌµÆµÄ½á¹û*/
  64   1              uint sou_nor_nums = 0;/* ÄÏ±±·½ÏòÉÏµÄ³µÁ÷Á¿×ÜºÍ*/
  65   1              uint eas_wes_nums = 0;/* ¶«Î÷·½ÏòÉÏµÄ³µÁ÷Á¿×ÜºÍ*/
  66   1              uint cycle_time = 0;/* Ñ­»·ÖÜÆÚµÄÊ±¼ä*/
  67   1              init_register_s52();
  68   1              init_max7219();
  69   1              quit_led();
  70   1              buzzer();
  71   1              send_comm_to_phone('9'); //ÏÂÎ»»ú¸´Î»
  72   1              while(1)
  73   1              {        
  74   2                      /*ÏµÍ³¿ªÊ¼¼ì²âÏµÍ³Ä£Ê½£¬µ±OK¼üÔÚËùÓÐ¼üÒÔ¼°ÊÖ»ú¿ØÖÆÖ®Ç°°´ÏÂÊ±Îª×Ô¶¯Ä£Ê½,Ã¿¸ö·½Ïò¼ÆÊ±20s
  75   2                       *                                              ·ñÔòÍ¨¹ýÆäËû·½Ê½£¨ÆäËû°´¼ü»òÕßÊÖ»ú¶Ë£©ÉèÖÃºóÔÙ´Î°´ÏÂÏµÍ³Æô¶¯
  76   2                       *
  77   2                       *¿ªÊ¼¼ì²â°´¼ü»òÊÖ»úÔ¶³ÌÉèÖÃ
  78   2                       */
  79   2                      key_num = scankey();
  80   2                      if((key_num==OK) || (Phone_OK_Finish==1))//°´¼ü¶ËÖ±½Ó¿ØÖÆ£¬ÏµÍ³ÕýÊ½Æô¶¯ 
  81   2                      {
  82   3                              if(key_num==OK)
  83   3                              {
  84   4                                      send_comm_to_phone('0'); //ÏÂÎ»»úÍ¨¹ý°´¼ü¿ªÆô
  85   4                              }
  86   3                              Phone_OK_Finish = 0;
  87   3                              init_led();
  88   3                              init_Numeric_Display();
  89   3                              clearFlag();
  90   3                              TR0 = 1;        
  91   3      
  92   3                              cycle_time = Sou_Nor_Green_Time + Sou_Nor_Red_Time + Sou_Nor_Yellow_Time + West_East_Yellow_Time;               
  93   3                              send_cycle_time_to_phone('8',cycle_time);//·¢ËÍÑ­»·Ê±¼ä           
  94   3                              while(1)
  95   3                              {
  96   4                                      /*
  97   4                                       * ÊÖ»ú¶ËÔ¶³Ì¿ØÖÆÄ£¿é
  98   4                                       */
  99   4                                      phone_remote_control();
 100   4                                      /*
 101   4                                       *½ô¼±Çé¿öÄ£¿é
 102   4                                       */
 103   4                                      if(enter_stop_flag == 1)//½ô¼±Çé¿ö±ê¼Ç
 104   4                                      {       
 105   5                                              TR0 = 0;//½ûÍ£ºó£¬¹Ø±Õ¶¨Ê±Æ÷ 
 106   5                                              all_led_red();
 107   5                                              send_comm_to_phone('2');//¿ªÆô½ûÍ£
 108   5                                              while(enter_stop_flag)
 109   5                                              {
 110   6                                                      key_num = scankey();
 111   6                                                      phone_remote_control();
 112   6                                                      if((OK==key_num) || (Phone_OK_Finish == 1) || (quit_stop_flag==1))
 113   6                                                      {
 114   7                                                              key_num = 17;
 115   7                                                              enter_stop_flag = 0;
 116   7                                                              Phone_OK_Finish = 0;             
 117   7                                                              quit_stop_flag = 0;
C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 3   

 118   7                                                              TR0 = 1;//ÔÙ´ÎÆô¶¯¶¨Ê±Æ÷  
 119   7                                                              send_comm_to_phone('3');//¹Ø±Õ½ûÍ£
 120   7                                                      }
 121   6                                              }
 122   5                                      }
 123   4                                      /*
 124   4                                       * ´³ºìµÆ¼ì²âÄ£¿é
 125   4                                       */
 126   4                                       run_red_light_result = run_red_light();
 127   4                                       if(run_red_light_result != 0)
 128   4                                       {
 129   5                                              buzzer();
 130   5                                              //½«´³ºìµÆ¾ßÌå·½Î»Êý¾ÝÍ¨¹ý´®¿Ú×ªÀ¶ÑÀ´«ËÍµ½ÊÖ»úÖÕ¶Ë
 131   5                                              //Êý¾ÝCRC·â×°
 132   5                                              send_run_red_light_to_phone('4',run_red_light_result);
 133   5                                              run_red_light_result = 0;
 134   5                                       }
 135   4                                      /*
 136   4                                       * ³µÁ¾¼ì²âÄ£¿é
 137   4                                       */
 138   4                                      //µÃµ½Ã¿¸ö·½ÏòÉÏµÄ³µÁ÷Á¿´¢´æµ½car_numÊý×éÖÐ
 139   4                                      car_flow_detection(car_num);
 140   4                                      //¼ÆËãÄÏ±±¡¢¶«Î÷·½ÏòÉÏµÄ³µÁ¾ÊýËãÊýÆ½¾ùÖµ£¬Ä£ÄâÈ¡³öÕûÊýÖµ
 141   4                                      sou_nor_nums = (car_num[1]+car_num[3])/cycle_nums;
 142   4                                      eas_wes_nums = (car_num[0]+car_num[2])/cycle_nums;
 143   4                                      //¼ÆËãÑ­»·ÖÜÆÚµÄÊ±¼äºÍ
 144   4                                      cycle_time = Sou_Nor_Green_Time + Sou_Nor_Red_Time + Sou_Nor_Yellow_Time + West_East_Yellow_Time;
 145   4                                      //¼ÆËã³µÁ÷Á¿
 146   4                                      //??????????
 147   4                                      //½«Á½¸ö·½ÏòÉÏµÄ³µÁ÷Á¿Êý¾ÝÍ¨¹ý´®¿Ú×ªÀ¶ÑÀ´«ËÍµ½ÊÖ»úÖÕ¶Ë
 148   4                                      //Êý¾ÝCRC·â×°
 149   4                                      //sou_nor_nums,eas_wes_nums,cycle_nums£¬cycle_time
 150   4                                      
 151   4                                      if(car_flow_detection_flag == 1)
 152   4                                      { 
 153   5                                              //Ò»¸öÑ­»·ÖÜÆÚ·¢ËÍÒ»´Î³µÁ÷Á¿×´Ì¬
 154   5                                              send_sou_nor_nums_to_phone('5',sou_nor_nums);
 155   5                                              delay(100);
 156   5                                              send_eas_wes_nums_to_phone('6',eas_wes_nums); 
 157   5                                              delay(100);
 158   5                                              send_cycle_nums_to_phone('7',cycle_nums);       
 159   5                                              delay(100);
 160   5                                              send_cycle_time_to_phone('8',cycle_time);//·¢ËÍÑ­»·Ê±¼ä 
 161   5                                              //Ä£Äâ¸Ä±äÄÏ±±¶«Î÷·½ÏòÉÏµÄºìÂÌµÆÊ±¼ä
 162   5                                              if(Sou_Nor_Green_Time <= small_time)
 163   5                                              {
 164   6                                              if(sou_nor_nums > 10)//10Á¾
 165   6                                                      Sou_Nor_Green_Time = big_time;
 166   6                                              else
 167   6                                                      Sou_Nor_Green_Time = small_time;        
 168   6                                              }
 169   5                                              else if((Sou_Nor_Green_Time>small_time) && Sou_Nor_Green_Time<=big_time)
 170   5                                              {
 171   6                                              if(sou_nor_nums <= 10)
 172   6                                                      Sou_Nor_Green_Time = small_time; 
 173   6                                              else
 174   6                                                      Sou_Nor_Green_Time = big_time;
 175   6                                              }
 176   5                                              else if(Sou_Nor_Green_Time > big_time)
 177   5                                              {
 178   6                                              if(sou_nor_nums <= 20)
 179   6                                                      Sou_Nor_Green_Time = small_time; 
C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 4   

 180   6                                              else if((sou_nor_nums>20) && (sou_nor_nums <= 40))
 181   6                                                      Sou_Nor_Green_Time = big_time + 10;
 182   6                                              else if((sou_nor_nums>40) && (sou_nor_nums <= 70))
 183   6                                                      Sou_Nor_Green_Time = big_time + 20;
 184   6                                              else
 185   6                                                      Sou_Nor_Green_Time = 99;
 186   6                                              }
 187   5                                              //ÆäËûµÄÕý³£
 188   5                                              
 189   5                                              //Ä£Äâ¸Ä±ä¶«Î÷¶«Î÷·½ÏòÉÏµÄºìÂÌµÆÊ±
 190   5                                              if(Sou_Nor_Red_Time <= small_time)
 191   5                                              {
 192   6                                              if(eas_wes_nums > 10)//10Á¾
 193   6                                                      Sou_Nor_Red_Time = big_time;
 194   6                                              else
 195   6                                                      Sou_Nor_Red_Time = small_time;  
 196   6                                              }
 197   5                                              else if((Sou_Nor_Red_Time>small_time) && (Sou_Nor_Red_Time<=big_time))
 198   5                                              {
 199   6                                              if(eas_wes_nums <= 10)
 200   6                                                      Sou_Nor_Red_Time = small_time;
 201   6                                              else
 202   6                                                      Sou_Nor_Red_Time = big_time; 
 203   6                                              }
 204   5                                              else if(Sou_Nor_Red_Time > big_time)
 205   5                                              {
 206   6                                              if(eas_wes_nums <= 20)
 207   6                                                      Sou_Nor_Red_Time = small_time; 
 208   6                                              else if((eas_wes_nums>20) && (eas_wes_nums <= 40))
 209   6                                                      Sou_Nor_Red_Time = big_time + 10;
 210   6                                              else if((eas_wes_nums>40) && (eas_wes_nums <= 70))
 211   6                                                      Sou_Nor_Red_Time = big_time + 20;
 212   6                                              else
 213   6                                                      Sou_Nor_Red_Time = 99;
 214   6                                              } 
 215   5                                              Sou_Nor_Green_Time_Temp = Sou_Nor_Green_Time;
 216   5                                              Sou_Nor_Red_Time_Temp = Sou_Nor_Red_Time;
 217   5                                              
 218   5                                              car_flow_detection_flag = 0;//×Ô¶¯Ñ­»·Ä£Ê½±ê¼Ç¼ì²â´¦Àí½áÊø£¬ÖÃª0        
 219   5                                      }
 220   4                                      if((sou_nor_nums>999) || (eas_wes_nums>999))//ÖØÖÃ³µÁ÷Á¿Êý¾Ý£¬²¢½«Ñ­»·´ÎÊýÉèÖÃÎª0
 221   4                                      {
 222   5                                              car_num[0] = 0;
 223   5                                              car_num[1] = 0;
 224   5                                              car_num[2] = 0;
 225   5                                              car_num[3] = 0;
 226   5                                              cycle_nums  = 0;
 227   5                                      }
 228   4                              }
 229   3                      }
 230   2                      /*
 231   2                       *      Ê±¼äÊÖ¶¯ÉèÖÃÄ£¿é
 232   2                       *  1¡¢ÏÂÎ»»ú°´¼üÄ£¿é
 233   2                       *  2¡¢ÊÖ»ú¶ËÃüÁîÉèÖÃÄ£¿é
 234   2                       */
 235   2                      //OK¼üÃ»ÓÐ°´ÏÂ£¬´ËÊ±ÊÇÓÃ»§×Ô¼ºÉèÖÃ¸÷·½ÏòµÄºì»ÆÂÌµÆÊ±¼ä,ÐÞ¸ÄµÄÊÇ¶ÔÓ¦·½ÏòÉÏµÄÂÌµÆÊ±¼ä
 236   2                      //1¡¢ÏÂÎ»»ú°´¼üÄ£¿é
 237   2                      if(key_num == SET_SOU_NOR_TIME)//ÉèÖÃÄÏ±±·½ÏòÂÌµÆÊ±¼ä
 238   2                      {
 239   3                              wr_max7219(Addr_Digit2,0x00);    
 240   3                              wr_max7219(Addr_Digit3,0x00);   
 241   3                              set_time(1);//ÄÏ±±      
C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 5   

 242   3                      }
 243   2                      if(key_num == SET_WEST_EAST_TIME)
 244   2                      {
 245   3                              wr_max7219(Addr_Digit0,0x00);    
 246   3                              wr_max7219(Addr_Digit1,0x00);                           
 247   3                              set_time(2);
 248   3                      }
 249   2                      //2¡¢ÊÖ»ú¶ËÃüÁîÉèÖÃÄ£¿é
 250   2                      phone_remote_control();
 251   2              }
 252   1              return 0;
 253   1      }
 254          
 255          /*
 256           * ÊÖ»ú¶Ë
 257           */
 258          void phone_remote_control()     
 259          {
 260   1      //      uint i;
 261   1              switch(uartState)
 262   1              {
 263   2                      case UART_IDLE://´®¿ÚÎ´ÓÐÊý¾Ý×´Ì¬
 264   2                      {
 265   3                              pointer = 0;
 266   3                              timeout = 0;
 267   3                              g_cCommand = 0;
 268   3                              if(checkByte())  
 269   3                              {  
 270   4                                      recieve_Buf[pointer++] = getByte();   
 271   4                                      uartState = UART_RECEIVE;
 272   4                              }
 273   3                              break;
 274   3                      }
 275   2                      case UART_RECEIVE:
 276   2                      {
 277   3                              timeout++;
 278   3                              if ((timeout>0x8000) || (recieve_Buf[(pointer-1)]=='F') || (pointer>7) || (pointer >= (recieve_Buf[1])-
             -'0'))//[0]±íÊ¾Êý¾Ý³¤¶È
 279   3                              {
 280   4                                      uartState = UART_PROCESS; 
 281   4                                      break;
 282   4                              }
 283   3                              if(checkByte())  
 284   3                              {
 285   4                                      recieve_Buf[pointer++] = getByte();
 286   4                                      timeout = 0;
 287   4                                      uartState = UART_RECEIVE;
 288   4                              }
 289   3                              break;
 290   3                      }
 291   2                      case UART_PROCESS:
 292   2                      {
 293   3                              //½«ÊÖ»ú¶Ë½ÓÊÕµ½µÄ×Ö·û´®×ª»»Îª16½øÖÆ
 294   3                              uartState = UART_IDLE; 
 295   3      
 296   3      //                      for(i=0; i<pointer;i++)
 297   3      //                      {
 298   3      //                              sendByte(recieve_Buf[i]);
 299   3      //                              delay(1);
 300   3      //                      }
 301   3      
 302   3                              g_cCommand = recieve_Buf[2] ; //È¡³ö¹¦ÄÜÃüÁî×Ö
C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 6   

 303   3      //                                      i =     g_cReceBuf[0]-2;
 304   3      //                                      CRCdata = CRC16(g_cReceBuf,i);//½øÐÐCRCÑ­»·Ð£Ñé
 305   3      
 306   3                              if((timeout<0x8000) && (recieve_Buf[0]=='$')/* && (CRCdata==(u16)(g_cReceBuf[i]<<8)+g_cReceBuf[i+1])*/ 
             -)
 307   3                              {
 308   4                                      switch(g_cCommand)
 309   4                                      {
 310   5                                              
 311   5                                              case '0'://ÊÖ»úÈ·ÈÏÉèÖÃÍê±Ï
 312   5                                                      Phone_OK_Finish = 1; 
 313   5                                                      buzzer();         
 314   5                                                      break;
 315   5                                              case '1'://ÉèÖÃÊ±¼ä
 316   5                                              {
 317   6                                                      if(recieve_Buf[3] == '1')//ÉèÖÃÄÏ±±ÂÌµÆÊ±¼ä
 318   6                                                      {                                               
 319   7                                                              Sou_Nor_Green_Time = (recieve_Buf[4] - '0')*10 + (recieve_Buf[5] - '0');//×Ö·ûµÄASCII
 320   7                                                              Sou_Nor_Green_Time_Temp =  Sou_Nor_Green_Time;
 321   7                                                              wr_max7219(Addr_Digit0,max7219_7led_code[Sou_Nor_Green_Time_Temp/10]);   
 322   7                                                              wr_max7219(Addr_Digit1,max7219_7led_code[Sou_Nor_Green_Time_Temp%10]);
 323   7                                                      }
 324   6                                                      if(recieve_Buf[3] == '2')//ÉèÖÃ¶«Î÷ÂÌµÆÊ±¼ä
 325   6                                                      {                                                        
 326   7                                                              Sou_Nor_Red_Time = (recieve_Buf[4] - '0')*10 + (recieve_Buf[5] - '0');
 327   7                                                              Sou_Nor_Red_Time_Temp =  Sou_Nor_Red_Time;
 328   7                                                              wr_max7219(Addr_Digit2,max7219_7led_code[Sou_Nor_Red_Time_Temp/10]);     
 329   7                                                              wr_max7219(Addr_Digit3,max7219_7led_code[Sou_Nor_Red_Time_Temp%10]);
 330   7                                                      }
 331   6                                                      buzzer();       
 332   6                                                      break;
 333   6                                              }
 334   5                                              case '2'://½ûÖ¹Í¨ÐÐ
 335   5                                                      enter_stop_flag = 1;
 336   5                                                      buzzer();
 337   5                                                      break;
 338   5                                              case '3'://¿ªÆôÍ¨ÐÐ
 339   5                                                      quit_stop_flag = 1;
 340   5                                                      buzzer();
 341   5                                                      break;
 342   5                                              default:
 343   5                                                      break;
 344   5                                      }
 345   4                              }
 346   3                              break;
 347   3                      }
 348   2              } 
 349   1      }
 350          /*
 351           *³õÊ¼»¯52µ¥Æ¬»úµÄ¼Ä´æÆ÷£¬Íâ²¿ÖÐ¶Ï£¬¶¨Ê±Æ÷£¬ÒÔ¼°ÏàÒÀÓÅÏÈ¼¶µÈ
 352           */
 353          void init_register_s52()
 354          {       
 355   1              //CPU²éÑ¯ÖÐ¶ÏµÄË³Ðò£¨INT0->T0->INT1->TI/RI->T2£©
 356   1              IE = 0X97;//´ò¿ªÏàÓ¦ÖÐ¶Ï((EA(×Ü¿ª¹Ø)-1))--(²»ÓÃ-0)--(T2-0)--(´®ÐÐ¿Ú-1)
 357   1                                                       //--(T1-0)--(INT1-1)--(T0-1)--(INT0-1))
 358   1              TMOD = 0X21;//T1·½Ê½2£¬T0·½Ê½1ÉèÖÃ£¨GATE-C/T-M1-M0--GATE-C/T-M1-M0£©
 359   1              IT0 = 1;//INT0ÏÂ½µÑØÓÐÐ§
 360   1              IT1 = 1;//ÏÂ½µÑØÓÐÐ§
 361   1              TL1 = 0XFD;
 362   1              TH0 = 0X4C;//¶¨Ê±Æ÷
 363   1              TL0 = 0X00;
C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 7   

 364   1              //TR0 = 1;//Æô¶¯¶¨Ê±Æ÷
 365   1              
 366   1              TH1 = 0XFD;//²¨ÌØÂÊ9600,SMOD²»¼Ó±¶
 367   1              TL1 = 0XFD;
 368   1              TR1 = 1;//Æô¶¯T1
 369   1              SCON = 0X50;//´®¿Ú·½Ê½£¬·½Ê½1£¬ÔÊÐí½ÓÊÕ
 370   1      
 371   1              PS = 1; //´®ÐÐ¿ÚÓÅÏÈ¼¶
 372   1              PX0 = 1; 
 373   1              PX1 = 1;//INT1ÖÐ¶ÏÓÅÏÈ¼¶
 374   1              //IP = 0X21;//(²»ÓÃ-²»ÓÃ-T2-´®ÐÐ¿Ú-T1-INT1-T0-INT0)
 375   1              Sou_Nor_Red_Time_Temp = Sou_Nor_Red_Time;
 376   1              Sou_Nor_Green_Time_Temp = Sou_Nor_Green_Time;
 377   1      }
 378          
 379          /*
 380           *³õÊ¼»¯ÊýÂë¹ÜÏÔÊ¾Êý×Ö,ÒÔÄÏ±±Îª»ù×¼ÏÔÊ¾£¬Ò²¾ÍÊÇÏÔÊ¾µÄÊÇµ±Ç°ÄÏ±±Í¨ÐÐÊ±ÂÌµÆÊ±¼ä
 381           */
 382          void init_Numeric_Display()
 383          {
 384   1              wr_max7219(Addr_Digit0,max7219_7led_code[Sou_Nor_Green_Time_Temp/10]);   
 385   1              wr_max7219(Addr_Digit1,max7219_7led_code[Sou_Nor_Green_Time_Temp%10]);
 386   1              wr_max7219(Addr_Digit2,max7219_7led_code[Sou_Nor_Green_Time_Temp/10]);   
 387   1              wr_max7219(Addr_Digit3,max7219_7led_code[Sou_Nor_Green_Time_Temp%10]);
 388   1      }
 389          
 390          
 391          
 392          
 393          
 394          
 395          
 396          
 397          
 398          
 399          
 400          
 401          
 402          
 403          
 404          
 405          
 406          
 407          
 408          
 409          
 410          
 411          
 412          
 413          
 414          
 415          
 416          
 417          
 418          
 419          
 420          
 421          
 422          
 423          
 424          
 425          
C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 8   

 426          
 427          
 428          
 429          
 430          
 431          
 432          
 433          /*
 434           *½«ËùÓÐÓÃIO¿ÚÀ©Õ¹µÄ°´¼üÈ«²¿Çå³ý£¬ÖÃÎª¸ßµçÆ½
 435           */
 436          //void remove_key()
 437          //{
 438          //      West_East_Add_Button = 1;
 439          //      Sou_Nor_Add_Button = 1;
 440          //      SUB_TIME = 1;
 441          //      OK = 1;
 442          //}
 443          /*
 444           *ÊÖ¶¯¿ØÖÆÄ£Ê½ÏÂ£ºÉèÖÃÄÏ±±ÂÌµÆÊ±¼ä
 445           */
 446          //uchar set_sou_nor_time()
 447          //{
 448          //      uchar count = 20;
 449          //      while(1)
 450          //      {
 451          //              if(Sou_Nor_Add_Button==0)
 452          //              {
 453          //                      buzzer();
 454          //                      count++;                        
 455          //              }
 456          //              if(SUB_TIME==0)
 457          //              {
 458          //                      buzzer();  
 459          //                      count--;
 460          //              }
 461          //              if(OK == 0)
 462          //              {
 463          //                      delay(100);
 464          //                      buzzer(); 
 465          //                      break;
 466          //              }
 467          //              remove_key();
 468          //              
 469          //      }
 470          //}
 471          /*
 472           *ÊÖ¶¯¿ØÖÆÄ£Ê½ÏÂ£ºÉèÖÃ¶«Î÷ÂÌµÆÊ±¼ä
 473           */
 474          //uchar set_west_east_time()
 475          //{
 476          //      uchar count = 20;
 477          //      while(1)         
 478          //      {
 479          //              if(West_East_Add_Button==0)
 480          //              {
 481          //                      buzzer(); 
 482          //                      count++;
 483          //              }
 484          //              if(SUB_TIME==0)
 485          //              {
 486          //                      buzzer();
 487          //                      count--;
C51 COMPILER V9.00   MAIN                                                                  04/12/2016 21:21:40 PAGE 9   

 488          //              }
 489          //              if(OK == 0)
 490          //              {
 491          //                      delay(100);
 492          //                      buzzer();
 493          //                      break;
 494          //              }
 495          //              remove_key();
 496          //      }
 497          //      return count;   
 498          //}


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1283    ----
   CONSTANT SIZE    =      2    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     54       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
